'use strict';

var Test = require('../test');
<<<<<<< HEAD
var EVENT_FILE_PRE_REQUIRE =
  require('../suite').constants.EVENT_FILE_PRE_REQUIRE;
=======
var EVENT_FILE_PRE_REQUIRE = require('../suite').constants
  .EVENT_FILE_PRE_REQUIRE;
>>>>>>> c8966f740229d8b8975b213b123cc1dcb439f59a

/**
 * QUnit-style interface:
 *
 *     suite('Array');
 *
 *     test('#length', function() {
 *       var arr = [1,2,3];
 *       ok(arr.length == 3);
 *     });
 *
 *     test('#indexOf()', function() {
 *       var arr = [1,2,3];
 *       ok(arr.indexOf(1) == 0);
 *       ok(arr.indexOf(2) == 1);
 *       ok(arr.indexOf(3) == 2);
 *     });
 *
 *     suite('String');
 *
 *     test('#length', function() {
 *       ok('foo'.length == 3);
 *     });
 *
 * @param {Suite} suite Root suite.
 */
module.exports = function qUnitInterface(suite) {
  var suites = [suite];

<<<<<<< HEAD
  suite.on(EVENT_FILE_PRE_REQUIRE, function (context, file, mocha) {
=======
  suite.on(EVENT_FILE_PRE_REQUIRE, function(context, file, mocha) {
>>>>>>> c8966f740229d8b8975b213b123cc1dcb439f59a
    var common = require('./common')(suites, context, mocha);

    context.before = common.before;
    context.after = common.after;
    context.beforeEach = common.beforeEach;
    context.afterEach = common.afterEach;
    context.run = mocha.options.delay && common.runWithSuite(suite);
    /**
     * Describe a "suite" with the given `title`.
     */

<<<<<<< HEAD
    context.suite = function (title) {
=======
    context.suite = function(title) {
>>>>>>> c8966f740229d8b8975b213b123cc1dcb439f59a
      if (suites.length > 1) {
        suites.shift();
      }
      return common.suite.create({
<<<<<<< HEAD
        title,
        file,
=======
        title: title,
        file: file,
>>>>>>> c8966f740229d8b8975b213b123cc1dcb439f59a
        fn: false
      });
    };

    /**
     * Exclusive Suite.
     */

<<<<<<< HEAD
    context.suite.only = function (title) {
=======
    context.suite.only = function(title) {
>>>>>>> c8966f740229d8b8975b213b123cc1dcb439f59a
      if (suites.length > 1) {
        suites.shift();
      }
      return common.suite.only({
<<<<<<< HEAD
        title,
        file,
=======
        title: title,
        file: file,
>>>>>>> c8966f740229d8b8975b213b123cc1dcb439f59a
        fn: false
      });
    };

    /**
     * Describe a specification or test-case
     * with the given `title` and callback `fn`
     * acting as a thunk.
     */

<<<<<<< HEAD
    context.test = function (title, fn) {
=======
    context.test = function(title, fn) {
>>>>>>> c8966f740229d8b8975b213b123cc1dcb439f59a
      var test = new Test(title, fn);
      test.file = file;
      suites[0].addTest(test);
      return test;
    };

    /**
     * Exclusive test-case.
     */

<<<<<<< HEAD
    context.test.only = function (title, fn) {
=======
    context.test.only = function(title, fn) {
>>>>>>> c8966f740229d8b8975b213b123cc1dcb439f59a
      return common.test.only(mocha, context.test(title, fn));
    };

    context.test.skip = common.test.skip;
<<<<<<< HEAD
=======
    context.test.retries = common.test.retries;
>>>>>>> c8966f740229d8b8975b213b123cc1dcb439f59a
  });
};

module.exports.description = 'QUnit style';
